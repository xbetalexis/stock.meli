<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Stock</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:sans-serif;background:#020617;color:white;padding:10px}
input,button{padding:8px;margin:5px}
.card{background:#0f172a;padding:10px;border-radius:8px;margin-top:10px}
.low{color:red}
</style>
</head>
<body>

<h2>ðŸ“¦ Stock</h2>

<input id="nombre" placeholder="Producto">
<input id="cantidad" type="number" placeholder="Cantidad">
<button onclick="agregar()">Agregar</button>

<div id="lista"></div>

<script>
if(localStorage.getItem('auth')!=='ok')location.href='index.html'

let stock = JSON.parse(localStorage.getItem('stock')||'[]')

function guardar(){
  localStorage.setItem('stock',JSON.stringify(stock))
}

function cargar(){
  lista.innerHTML=''
  stock.forEach(p=>{
    lista.innerHTML+=`
    <div class="card">
      <b>${p.nombre}</b><br>
      Stock: <span class="${p.cantidad<=3?'low':''}">${p.cantidad}</span><br>
      <button onclick="mod('${p.id}',1)">+</button>
      <button onclick="mod('${p.id}',-1)">-</button>
    </div>`
  })
}

function agregar(){
  stock.push({
    id:Date.now().toString(),
    nombre:nombre.value,
    cantidad:+cantidad.value
  })
  guardar()
  cargar()
  nombre.value=''
  cantidad.value=''
}

function mod(id,val){
  const p=stock.find(x=>x.id===id)
  if(p){
    p.cantidad+=val
    if(p.cantidad<0)p.cantidad=0
    guardar()
    cargar()
  }
}

cargar()
</script>
</body>
</html>
